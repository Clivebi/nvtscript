CPE = "cpe:/a:samba:samba";
if(description){
	script_oid( "1.3.6.1.4.1.25623.1.0.150740" );
	script_version( "2021-09-28T14:52:06+0000" );
	script_tag( name: "last_modification", value: "2021-10-06 10:22:49 +0000 (Wed, 06 Oct 2021)" );
	script_tag( name: "creation_date", value: "2021-09-28 14:46:51 +0000 (Tue, 28 Sep 2021)" );
	script_tag( name: "cvss_base", value: "4.6" );
	script_tag( name: "cvss_base_vector", value: "AV:L/AC:L/Au:N/C:P/I:P/A:P" );
	script_cve_id( "CVE-1999-1288" );
	script_tag( name: "qod_type", value: "remote_banner_unreliable" );
	script_tag( name: "solution_type", value: "VendorFix" );
	script_name( "Samba 1.9.18 Elevate Privileges Vulnerability (CVE-1999-1288)" );
	script_category( ACT_GATHER_INFO );
	script_copyright( "Copyright (C) 2021 Greenbone Networks GmbH" );
	script_family( "General" );
	script_dependencies( "smb_nativelanman.sc", "gb_samba_detect.sc" );
	script_mandatory_keys( "samba/smb_or_ssh/detected" );
	script_tag( name: "summary", value: "Samba is prone to a elevate privileges vulnerability." );
	script_tag( name: "vuldetect", value: "Checks if a vulnerable version is present on the target host." );
	script_tag( name: "insight", value: "Samba 1.9.18 inadvertently includes a prototype application,
  wsmbconf, which is installed with incorrect permissions including the setgid bit, which allows
  local users to read and write files and possibly gain privileges via bugs in the program." );
	script_tag( name: "affected", value: "Samba version 1.9.18." );
	script_tag( name: "solution", value: "Update to version 1.9.19 or later." );
	exit( 0 );
}
require("host_details.inc.sc");
require("version_func.inc.sc");
if(isnull( port = get_app_port( cpe: CPE ) )){
	exit( 0 );
}
if(!infos = get_app_version_and_location( cpe: CPE, port: port, exit_no_version: TRUE )){
	exit( 0 );
}
version = infos["version"];
location = infos["location"];
if(version_is_equal( version: version, test_version: "1.9.18" )){
	report = report_fixed_ver( installed_version: version, fixed_version: "1.9.19", install_path: location );
	security_message( port: port, data: report );
	exit( 0 );
}
exit( 99 );

