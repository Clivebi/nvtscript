CPE = "cpe:/o:cisco:nx-os";
if(description){
	script_oid( "1.3.6.1.4.1.25623.1.0.105706" );
	script_cve_id( "CVE-2015-0775" );
	script_tag( name: "cvss_base", value: "5.0" );
	script_tag( name: "cvss_base_vector", value: "AV:N/AC:L/Au:N/C:N/I:N/A:P" );
	script_version( "2019-10-09T06:43:33+0000" );
	script_name( "Cisco Nexus and Cisco Multilayer Director Switches MOTD Telnet Login Reset Vulnerability" );
	script_xref( name: "URL", value: "http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-SA-20150610-CVE-2015-0775" );
	script_tag( name: "vuldetect", value: "Checks if a vulnerable version is present on the target host." );
	script_tag( name: "solution", value: "See the referenced vendor advisory for a solution." );
	script_tag( name: "summary", value: "A vulnerability in the Message of the Day (MOTD) or banner functionality of the NX-OS Software could
allow an unauthenticated, remote attacker to cause the login process to reset.



The vulnerability is due to the MOTD display handling when a certain type of terminal session is
requested via Telnet. An attacker could exploit this vulnerability by repeatedly issuing a Telnet
session to the NX-OS device, causing the login process to reset. An exploit could allow the attacker
to cause the login process of the NX-OS device to reset repeatedly.

Cisco has confirmed the vulnerability. However, software updates are not available.


To exploit this vulnerability, an attacker would need to start a Telnet session with the targeted
device. This requirement may decrease the likelihood of a successful exploit depending on how the
targeted device is configured.

Cisco indicates through the CVSS score that functional exploit code exists. However, the code is not
known to be publicly available." );
	script_tag( name: "qod_type", value: "package" );
	script_tag( name: "solution_type", value: "VendorFix" );
	script_tag( name: "last_modification", value: "2019-10-09 06:43:33 +0000 (Wed, 09 Oct 2019)" );
	script_tag( name: "creation_date", value: "2016-05-12 16:23:46 +0200 (Thu, 12 May 2016)" );
	script_category( ACT_GATHER_INFO );
	script_family( "CISCO" );
	script_copyright( "This script is Copyright (C) 2016 Greenbone Networks GmbH" );
	script_dependencies( "gb_cisco_nx_os_version.sc" );
	script_mandatory_keys( "cisco_nx_os/version", "cisco_nx_os/model", "cisco_nx_os/device" );
	exit( 0 );
}
require("host_details.inc.sc");
require("version_func.inc.sc");
if(!version = get_app_version( cpe: CPE )){
	exit( 0 );
}
if(!device = get_kb_item( "cisco_nx_os/device" )){
	exit( 0 );
}
if(!ContainsString( device, "Nexus" )){
	exit( 0 );
}
if(!nx_model = get_kb_item( "cisco_nx_os/model" )){
	exit( 0 );
}
if(IsMatchRegexp( nx_model, "^3[0-9]+" )){
	affected = make_list( "7.2(0)ZN(99.67)" );
}
if(IsMatchRegexp( nx_model, "^4[0-9]+" )){
	affected = make_list( "4.1(2)E1(1f)" );
}
if(IsMatchRegexp( nx_model, "^5[0-9]+" )){
	affected = make_list( "6.0(2)N2(2)" );
}
if(IsMatchRegexp( nx_model, "^7[0-9]+" )){
	affected = make_list( "6.2(12)" );
}
if(IsMatchRegexp( nx_model, "^N9K" )){
	affected = make_list( "7.0(3)" );
}
for af in affected {
	if(version == af){
		report = report_fixed_ver( installed_version: version, fixed_version: "See advisory" );
		security_message( port: 0, data: report );
		exit( 0 );
	}
}
exit( 99 );

