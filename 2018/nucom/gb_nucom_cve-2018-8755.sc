CPE = "cpe:/h:nucom:nc-wr644gacv";
if(description){
	script_oid( "1.3.6.1.4.1.25623.1.0.141263" );
	script_version( "2021-06-30T11:00:43+0000" );
	script_tag( name: "last_modification", value: "2021-06-30 11:00:43 +0000 (Wed, 30 Jun 2021)" );
	script_tag( name: "creation_date", value: "2018-07-03 11:17:10 +0200 (Tue, 03 Jul 2018)" );
	script_tag( name: "cvss_base", value: "5.0" );
	script_tag( name: "cvss_base_vector", value: "AV:N/AC:L/Au:N/C:P/I:N/A:N" );
	script_tag( name: "severity_vector", value: "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H" );
	script_tag( name: "severity_origin", value: "NVD" );
	script_tag( name: "severity_date", value: "2019-10-03 00:03:00 +0000 (Thu, 03 Oct 2019)" );
	script_cve_id( "CVE-2018-8755" );
	script_tag( name: "qod_type", value: "exploit" );
	script_tag( name: "solution_type", value: "VendorFix" );
	script_name( "NuCom NC-WR644GACV File Download Vulnerability" );
	script_category( ACT_GATHER_INFO );
	script_copyright( "Copyright (C) 2018 Greenbone Networks GmbH" );
	script_family( "General" );
	script_dependencies( "gb_nucom_device_detect.sc" );
	script_mandatory_keys( "nucom_device/detected" );
	script_tag( name: "summary", value: "NuCom WR644GACV devices before STA006 allow an attacker to download the
configuration file without credentials. By downloading this file, an attacker can access the admin password, WPA
key, and any config information of the device." );
	script_tag( name: "impact", value: "Unauthenticated attackers may obtain the admin password and other sensitive
information which may lead to further attacks." );
	script_tag( name: "vuldetect", value: "Sends a crafted HTTP GET request and checks the response." );
	script_tag( name: "solution", value: "Update to STA006 or later." );
	script_xref( name: "URL", value: "https://blog.nivel4.com/investigaciones/vulnerabilidad-en-los-dispositivos-nucom-wr644gacv/" );
	exit( 0 );
}
require("host_details.inc.sc");
require("http_func.inc.sc");
require("http_keepalive.inc.sc");
if(!port = get_app_port( cpe: CPE, service: "www" )){
	exit( 0 );
}
if(!get_app_location( cpe: CPE, port: port, nofork: TRUE )){
	exit( 0 );
}
url = "/cgi-bin/config_download.cgi?action=download";
if(http_vuln_check( port: port, url: url, pattern: "Content-Disposition: attachment; filename=\"default.cfg\"", check_header: TRUE )){
	report = http_report_vuln_url( port: port, url: url );
	security_message( port: port, data: report );
	exit( 0 );
}
exit( 99 );

