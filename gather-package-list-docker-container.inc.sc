OS_CPE = make_array( "openSUSELeap15.1", "cpe:/o:opensuse:leap:15.1", "openSUSELeap15.0", "cpe:/o:opensuse:leap:15.0", "openSUSELeap42.3", "cpe:/o:opensuse:leap:42.3", "openSUSELeap42.2", "cpe:/o:opensuse:leap:42.2", "openSUSELeap42.1", "cpe:/o:opensuse:leap:42.1", "openSUSELeap42.0", "cpe:/o:opensuse:leap:42.0", "openSUSE13.2", "cpe:/o:novell:opensuse:13.2", "openSUSE13.1", "cpe:/o:novell:opensuse:13.1", "openSUSE12.3", "cpe:/o:novell:opensuse:12.3", "openSUSE12.2", "cpe:/o:novell:opensuse:12.2", "openSUSE12.1", "cpe:/o:novell:opensuse:12.1", "openSUSE11.4", "cpe:/o:novell:opensuse:11.4", "openSUSE11.3", "cpe:/o:novell:opensuse:11.3", "openSUSE11.2", "cpe:/o:novell:opensuse:11.2", "openSUSE11.1", "cpe:/o:novell:opensuse:11.1", "openSUSE11.0", "cpe:/o:novell:opensuse:11.0", "openSUSE10.3", "cpe:/o:novell:opensuse:10.3", "openSUSE10.2", "cpe:/o:novell:opensuse:10.2", "SUSE10.1", "cpe:/o:novell:suse_linux:10.1", "SUSE10.0", "cpe:/o:novell:suse_linux:10.0", "SUSE9.3", "cpe:/o:novell:suse_linux:9.3", "SUSE9.2", "cpe:/o:novell:suse_linux:9.2", "SUSE9.1", "cpe:/o:novell:suse_linux:9.1", "SUSE9.0", "cpe:/o:novell:suse_linux:9.0", "SUSE8.2", "cpe:/o:novell:suse_linux:8.2", "SUSE8.1", "cpe:/o:novell:suse_linux:8.1", "SUSE8.0", "cpe:/o:novell:suse_linux:8.0", "SUSE7.3", "cpe:/o:novell:suse_linux:7.3", "UCS4.2", "cpe:/o:univention:univention_corporate_server:4.2", "UCS4.1", "cpe:/o:univention:univention_corporate_server:4.1", "UCS4.0", "cpe:/o:univention:univention_corporate_server:4.0", "UCS3.3", "cpe:/o:univention:univention_corporate_server:3.3", "UCS3.2", "cpe:/o:univention:univention_corporate_server:3.2", "UCS3.1", "cpe:/o:univention:univention_corporate_server:3.1", "UCS3.0", "cpe:/o:univention:univention_corporate_server:3.0", "UCS2.4", "cpe:/o:univention:univention_corporate_server:2.4", "UCS2.3", "cpe:/o:univention:univention_corporate_server:2.3", "UCS2.2", "cpe:/o:univention:univention_corporate_server:2.2", "UCS2.1", "cpe:/o:univention:univention_corporate_server:2.1", "UCS2.0", "cpe:/o:univention:univention_corporate_server:2.0", "UBUNTU19.10", "cpe:/o:canonical:ubuntu_linux:19.10", "UBUNTU19.04", "cpe:/o:canonical:ubuntu_linux:19.04", "UBUNTU18.10", "cpe:/o:canonical:ubuntu_linux:18.10", "UBUNTU18.04 LTS", "cpe:/o:canonical:ubuntu_linux:18.04:-:lts", "UBUNTU17.10", "cpe:/o:canonical:ubuntu_linux:17.10", "UBUNTU17.04", "cpe:/o:canonical:ubuntu_linux:17.04", "UBUNTU16.10", "cpe:/o:canonical:ubuntu_linux:16.10", "UBUNTU16.04 LTS", "cpe:/o:canonical:ubuntu_linux:16.04:-:lts", "UBUNTU15.10", "cpe:/o:canonical:ubuntu_linux:15.10", "UBUNTU15.04", "cpe:/o:canonical:ubuntu_linux:15.04", "UBUNTU14.10", "cpe:/o:canonical:ubuntu_linux:14.10", "UBUNTU14.04 LTS", "cpe:/o:canonical:ubuntu_linux:14.04:-:lts", "UBUNTU13.10", "cpe:/o:canonical:ubuntu_linux:13.10", "UBUNTU13.04", "cpe:/o:canonical:ubuntu_linux:13.04", "UBUNTU12.10", "cpe:/o:canonical:ubuntu_linux:12.10", "UBUNTU12.04 LTS", "cpe:/o:canonical:ubuntu_linux:12.04", "UBUNTU11.10", "cpe:/o:canonical:ubuntu_linux:11.10", "UBUNTU11.04", "cpe:/o:canonical:ubuntu_linux:11.04", "UBUNTU10.10", "cpe:/o:canonical:ubuntu_linux:10.10", "UBUNTU10.04 LTS", "cpe:/o:canonical:ubuntu_linux:10.04:-:lts", "UBUNTU9.10", "cpe:/o:canonical:ubuntu_linux:9.10", "UBUNTU9.04", "cpe:/o:canonical:ubuntu_linux:9.04", "UBUNTU8.10", "cpe:/o:canonical:ubuntu_linux:8.10", "UBUNTU8.04 LTS", "cpe:/o:canonical:ubuntu_linux:8.04:-:lts", "UBUNTU7.10", "cpe:/o:canonical:ubuntu_linux:7.10", "UBUNTU7.04", "cpe:/o:canonical:ubuntu_linux:7.04", "UBUNTU6.10", "cpe:/o:canonical:ubuntu_linux:6.10", "UBUNTU6.06 LTS", "cpe:/o:canonical:ubuntu_linux:6.06:-:lts", "UBUNTU5.10", "cpe:/o:canonical:ubuntu_linux:5.10", "UBUNTU5.04", "cpe:/o:canonical:ubuntu_linux:5.04", "UBUNTU4.1", "cpe:/o:canonical:ubuntu_linux:4.10", "RH9", "cpe:/o:redhat:linux:9", "RH8.0", "cpe:/o:redhat:linux:8.0", "RH7.3", "cpe:/o:redhat:linux:7.3", "CentOS7", "cpe:/o:centos:centos:7", "CentOS6", "cpe:/o:centos:centos:6", "CentOS5", "cpe:/o:centos:centos:5", "CentOS4", "cpe:/o:centos:centos:4", "CentOS3", "cpe:/o:centos:centos:3", "CentOS2", "cpe:/o:centos:centos:2", "FC31", "cpe:/o:fedoraproject:fedora:31", "FC30", "cpe:/o:fedoraproject:fedora:30", "FC29", "cpe:/o:fedoraproject:fedora:29", "FC28", "cpe:/o:fedoraproject:fedora:28", "FC27", "cpe:/o:fedoraproject:fedora:27", "FC26", "cpe:/o:fedoraproject:fedora:26", "FC25", "cpe:/o:fedoraproject:fedora:25", "FC24", "cpe:/o:fedoraproject:fedora:24", "FC23", "cpe:/o:fedoraproject:fedora:23", "FC22", "cpe:/o:fedoraproject:fedora:22", "FC21", "cpe:/o:fedoraproject:fedora:21", "FC20", "cpe:/o:fedoraproject:fedora:20", "FC19", "cpe:/o:fedoraproject:fedora:19", "FC18", "cpe:/o:fedoraproject:fedora:18", "FC17", "cpe:/o:fedoraproject:fedora:17", "FC16", "cpe:/o:fedoraproject:fedora:16", "FC15", "cpe:/o:fedoraproject:fedora:15", "FC14", "cpe:/o:fedoraproject:fedora:14", "FC13", "cpe:/o:fedoraproject:fedora:13", "FC12", "cpe:/o:fedoraproject:fedora:12", "FC11", "cpe:/o:fedoraproject:fedora:11", "FC10", "cpe:/o:fedoraproject:fedora:10", "FC9", "cpe:/o:fedoraproject:fedora:9", "FC8", "cpe:/o:fedoraproject:fedora:8", "FC7", "cpe:/o:fedoraproject:fedora:7", "FC6", "cpe:/o:fedoraproject:fedora_core:6", "FC5", "cpe:/o:fedoraproject:fedora_core:5", "FC4", "cpe:/o:fedoraproject:fedora_core:4", "FC3", "cpe:/o:fedoraproject:fedora_core:3", "FC2", "cpe:/o:fedoraproject:fedora_core:2", "FC1", "cpe:/o:fedoraproject:fedora_core:1", "MNDK_2011.0", "cpe:/o:mandriva:linux:2011.0", "MNDK_2010.2", "cpe:/o:mandriva:linux:2010.2", "MNDK_2010.1", "cpe:/o:mandriva:linux:2010.1", "MNDK_2010.0", "cpe:/o:mandriva:linux:2010.0", "MNDK_2009.1", "cpe:/o:mandriva:linux:2009.1", "MNDK_2009.0", "cpe:/o:mandriva:linux:2009.0", "MNDK_2008.1", "cpe:/o:mandriva:linux:2008.1", "MNDK_2008.0", "cpe:/o:mandriva:linux:2008.0", "MNDK_2007.1", "cpe:/o:mandriva:linux:2007.1", "MNDK_2007.0", "cpe:/o:mandriva:linux:2007.0", "MNDK_2006.0", "cpe:/o:mandriva:linux:2006.0", "MNDK_mes5.2", "cpe:/o:mandriva:enterprise_server:5.2", "MNDK_mes5.1", "cpe:/o:mandriva:enterprise_server:5.1", "MNDK_mes5.0", "cpe:/o:mandriva:enterprise_server:5.0", "MNDK_mes5", "cpe:/o:mandriva:enterprise_server:5", "MNDK_10.1", "cpe:/o:mandrakesoft:mandrake_linux:10.1", "MNDK_10.0", "cpe:/o:mandrakesoft:mandrake_linux:10.0", "MNDK_9.2", "cpe:/o:mandrakesoft:mandrake_linux:9.2", "MNDK_9.1", "cpe:/o:mandrakesoft:mandrake_linux:9.1", "MNDK_9.0", "cpe:/o:mandrakesoft:mandrake_linux:9.0", "MNDK_8.2", "cpe:/o:mandrakesoft:mandrake_linux:8.2", "MNDK_8.1", "cpe:/o:mandrakesoft:mandrake_linux:8.1", "MNDK_8.0", "cpe:/o:mandrakesoft:mandrake_linux:8.0", "MNDK_7.2", "cpe:/o:mandrakesoft:mandrake_linux:7.2", "MAGEIA6", "cpe:/o:mageia:linux:6", "MAGEIA5", "cpe:/o:mageia:linux:5", "MAGEIA4.1", "cpe:/o:mageia:linux:4.1", "MAGEIA4", "cpe:/o:mageia:linux:4", "MAGEIA3", "cpe:/o:mageia:linux:3", "MAGEIA2", "cpe:/o:mageia:linux:2", "MAGEIA1", "cpe:/o:mageia:linux:1", "SLK14.2", "cpe:/o:slackware:slackware_linux:14.2", "SLK14.1", "cpe:/o:slackware:slackware_linux:14.1", "SLK14.0", "cpe:/o:slackware:slackware_linux:14.0", "SLK13.37", "cpe:/o:slackware:slackware_linux:13.37", "SLK13.1", "cpe:/o:slackware:slackware_linux:13.1", "SLK13.0", "cpe:/o:slackware:slackware_linux:13.0", "SLK12.2", "cpe:/o:slackware:slackware_linux:12.2", "SLK12.1", "cpe:/o:slackware:slackware_linux:12.1", "SLK12.0", "cpe:/o:slackware:slackware_linux:12.0", "SLK11.0", "cpe:/o:slackware:slackware_linux:11.0", "SLK10.2", "cpe:/o:slackware:slackware_linux:10.2", "SLK10.1", "cpe:/o:slackware:slackware_linux:10.1", "SLK10.0", "cpe:/o:slackware:slackware_linux:10.0", "SLK9.1", "cpe:/o:slackware:slackware_linux:9.1", "SLK9.0", "cpe:/o:slackware:slackware_linux:9.0", "SLK8.1", "cpe:/o:slackware:slackware_linux:8.1", "SLK8.0", "cpe:/o:slackware:slackware_linux:8.0", "SLK7.1", "cpe:/o:slackware:slackware_linux:7.1", "SLK7.0", "cpe:/o:slackware:slackware_linux:7.0", "SLK4.0", "cpe:/o:slackware:slackware_linux:4.0", "SLK3.9", "cpe:/o:slackware:slackware_linux:3.9", "SLK3.6", "cpe:/o:slackware:slackware_linux:3.6", "SLK3.5", "cpe:/o:slackware:slackware_linux:3.5", "SLK3.4", "cpe:/o:slackware:slackware_linux:3.4", "SLK3.3", "cpe:/o:slackware:slackware_linux:3.3", "SLK3.2", "cpe:/o:slackware:slackware_linux:3.2", "SLK3.1", "cpe:/o:slackware:slackware_linux:3.1", "SLK3.0", "cpe:/o:slackware:slackware_linux:3.0", "SLK2.3", "cpe:/o:slackware:slackware_linux:2.3", "SLK2.2", "cpe:/o:slackware:slackware_linux:2.2", "SLK2.1", "cpe:/o:slackware:slackware_linux:2.1", "SLK2.0", "cpe:/o:slackware:slackware_linux:2.0", "SLK1.1", "cpe:/o:slackware:slackware_linux:1.1", "SLK1.00", "cpe:/o:slackware:slackware_linux:1.00", "AMAZON", "cpe:/o:amazon:linux", "OracleLinux7.4", "cpe:/o:oracle:linux:7.4", "OracleLinux7.3", "cpe:/o:oracle:linux:7.3", "OracleLinux7.2", "cpe:/o:oracle:linux:7.2", "OracleLinux7.1", "cpe:/o:oracle:linux:7.1", "OracleLinux7.0", "cpe:/o:oracle:linux:7.0", "OracleLinux7", "cpe:/o:oracle:linux:7", "OracleLinux6.9", "cpe:/o:oracle:linux:6.9", "OracleLinux6.8", "cpe:/o:oracle:linux:6.8", "OracleLinux6.7", "cpe:/o:oracle:linux:6.7", "OracleLinux6.6", "cpe:/o:oracle:linux:6.6", "OracleLinux6.5", "cpe:/o:oracle:linux:6.5", "OracleLinux6.4", "cpe:/o:oracle:linux:6.4", "OracleLinux6.3", "cpe:/o:oracle:linux:6.3", "OracleLinux6.2", "cpe:/o:oracle:linux:6.2", "OracleLinux6.1", "cpe:/o:oracle:linux:6.1", "OracleLinux6.0", "cpe:/o:oracle:linux:6.0", "OracleLinux6", "cpe:/o:oracle:linux:6", "OracleLinux5.11", "cpe:/o:oracle:linux:5.11", "OracleLinux5.10", "cpe:/o:oracle:linux:5.10", "OracleLinux5.9", "cpe:/o:oracle:linux:5.9", "OracleLinux5.8", "cpe:/o:oracle:linux:5.8", "OracleLinux5.7", "cpe:/o:oracle:linux:5.7", "OracleLinux5.6", "cpe:/o:oracle:linux:5.6", "OracleLinux5.5", "cpe:/o:oracle:linux:5.5", "OracleLinux5.4", "cpe:/o:oracle:linux:5.4", "OracleLinux5.3", "cpe:/o:oracle:linux:5.3", "OracleLinux5.2", "cpe:/o:oracle:linux:5.2", "OracleLinux5.1", "cpe:/o:oracle:linux:5.1", "OracleLinux5.0", "cpe:/o:oracle:linux:5.0", "OracleLinux5", "cpe:/o:oracle:linux:5", "OracleLinux4.9", "cpe:/o:oracle:linux:4.9", "OracleLinux4.8", "cpe:/o:oracle:linux:4.8", "OracleLinux4.7", "cpe:/o:oracle:linux:4.7", "OracleLinux4.6", "cpe:/o:oracle:linux:4.6", "OracleLinux4.5", "cpe:/o:oracle:linux:4.5", "OracleLinux4", "cpe:/o:oracle:linux:4", "GENTOO", "cpe:/o:gentoo:linux", "ArchLinux", "cpe:/o:archlinux:arch_linux", "NixOS", "cpe:/o:nixos_project:nixos" );
func register_detected_docker_os( container_id, os, oskey, oscpe ){
	var container_id, os, oskey, oscpe;
	var cpe;
	if(!container_id || !os || !oskey || ( !OS_CPE[oskey] && !oscpe )){
		return;
	}
	if( oscpe ) {
		cpe = oscpe;
	}
	else {
		cpe = OS_CPE[oskey];
	}
	set_kb_item( name: "docker/lsc/container/" + container_id + "/OS", value: os );
	set_kb_item( name: "docker/lsc/container/" + container_id + "/OS-CPE", value: cpe );
	return make_array( "OS", chomp( os ), "OS-CPE", cpe );
}
func get_container_os( container_id, soc ){
	var container_id, soc;
	var bf, base_cmd, rls;
	if(!soc || !container_id){
		return;
	}
	base_cmd = "docker exec " + container_id + " ";
	rls = ssh_cmd( socket: soc, cmd: base_cmd + "cat /etc/system-release" );
	if(ContainsString( rls, "Amazon Linux AMI release" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Amazon Linux", oskey: "AMAZON" );
		return ret;
	}
	rls = ssh_cmd( socket: soc, cmd: base_cmd + "rpm -qf /etc/redhat-release" );
	if(ContainsString( rls, "oraclelinux-release-4" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		if( match = eregmatch( pattern: "oraclelinux-release-4.([0-9]+)", string: rls ) ){
			version = "4." + match[1];
		}
		else {
			version = "4";
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Oracle Linux " + version, oskey: "OracleLinux" + version );
		return ret;
	}
	if(ContainsString( rls, "oraclelinux-release-5" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		if( match = eregmatch( pattern: "oraclelinux-release-5.([0-9]+)", string: rls ) ){
			version = "5." + match[1];
		}
		else {
			version = "5";
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Oracle Linux " + version, oskey: "OracleLinux" + version );
		return ret;
	}
	if(ContainsString( rls, "oraclelinux-release-6" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		if( match = eregmatch( pattern: "oraclelinux-release-6.([0-9]+)", string: rls ) ){
			version = "6." + match[1];
		}
		else {
			version = "6";
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Oracle Linux " + version, oskey: "OracleLinux" + version );
		return ret;
	}
	if(ContainsString( rls, "oraclelinux-release-7" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		if( match = eregmatch( pattern: "oraclelinux-release-7.([0-9]+)", string: rls ) ){
			version = "7." + match[1];
		}
		else {
			version = "7";
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Oracle Linux " + version, oskey: "OracleLinux" + version );
		return ret;
	}
	rls = ssh_cmd( socket: soc, cmd: base_cmd + "cat /etc/redhat-release" );
	if(ContainsString( rls, "Red Hat Linux release 7.3" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "RH7.3" );
		return ret;
	}
	if(ContainsString( rls, "Red Hat Linux release 8.0 (Psyche)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "RH8.0" );
		return ret;
	}
	if(ContainsString( rls, "Red Hat Linux release 9 (Shrike)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "RH9" );
		return ret;
	}
	if(ContainsString( rls, "Fedora Core release 1 (Yarrow)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "FC1" );
		return ret;
	}
	if(ContainsString( rls, "Fedora Core release 2 (Tettnang)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "FC2" );
		return ret;
	}
	if(ContainsString( rls, "Fedora Core release 3 (Heidelberg)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "FC3" );
		return ret;
	}
	if(ContainsString( rls, "Fedora Core release 4 (Stentz)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "FC4" );
		return ret;
	}
	if(ContainsString( rls, "Fedora Core release 5 (Bordeaux)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "FC5" );
		return ret;
	}
	if(ContainsString( rls, "Fedora Core release 6 (Zod)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "FC6" );
		return ret;
	}
	if(ContainsString( rls, "Fedora release 7 (Moonshine)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "FC7" );
		return ret;
	}
	if(ContainsString( rls, "Fedora release 8 (Werewolf)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "FC8" );
		return ret;
	}
	if(ContainsString( rls, "Fedora release 9 (Sulphur)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "FC9" );
		return ret;
	}
	if(ContainsString( rls, "Fedora release 10 (Cambridge)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "FC10" );
		return ret;
	}
	if(ContainsString( rls, "Fedora release 11 (Leonidas)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "FC11" );
		return ret;
	}
	if(ContainsString( rls, "Fedora release 12 (Constantine)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "FC12" );
		return ret;
	}
	if(ContainsString( rls, "Fedora release 13 (Goddard)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "FC13" );
		return ret;
	}
	if(ContainsString( rls, "Fedora release 14 (Laughlin)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "FC14" );
		return ret;
	}
	if(ContainsString( rls, "Fedora release 15 (Lovelock)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "FC15" );
		return ret;
	}
	if(ContainsString( rls, "Fedora release 16 (Verne)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "FC16" );
		return ret;
	}
	if(ContainsString( rls, "Fedora release 17 (Beefy Miracle)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "FC17" );
		return ret;
	}
	if(ContainsString( rls, "Fedora release 18 (Spherical Cow)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "FC18" );
		return ret;
	}
	if(ContainsString( rls, "Fedora release 19" ) && ContainsString( rls, "Cat" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "FC19" );
		return ret;
	}
	if(ContainsString( rls, "Fedora release 20" ) && ContainsString( rls, "(Heisenbug)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "FC20" );
		return ret;
	}
	if(ContainsString( rls, "Fedora release 21" ) && ContainsString( rls, "(Twenty One)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "FC21" );
		return ret;
	}
	if(ContainsString( rls, "Fedora release 22" ) && ContainsString( rls, "(Twenty Two)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "FC22" );
		return ret;
	}
	if(ContainsString( rls, "Fedora release 23" ) && ContainsString( rls, "(Twenty Three)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "FC23" );
		return ret;
	}
	if(ContainsString( rls, "Fedora release 24" ) && ContainsString( rls, "(Twenty Four)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "FC24" );
		return ret;
	}
	if(ContainsString( rls, "Fedora release 25" ) && ContainsString( rls, "(Twenty Five)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "FC25" );
		return ret;
	}
	if(ContainsString( rls, "Fedora release 26" ) && ContainsString( rls, "(Twenty Six)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "FC26" );
		return ret;
	}
	if(ContainsString( rls, "Fedora release 27" ) && ContainsString( rls, "(Twenty Seven)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "FC27" );
		return ret;
	}
	if(ContainsString( rls, "Fedora release 28" ) && ContainsString( rls, "(Twenty Eight)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "FC28" );
		return ret;
	}
	if(ContainsString( rls, "Fedora release 29" ) && ContainsString( rls, "(Twenty Nine)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "FC29" );
		return ret;
	}
	if(ContainsString( rls, "Fedora release 30" ) && ContainsString( rls, "(Thirty)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "FC30" );
		return ret;
	}
	if(ContainsString( rls, "Fedora release 31" ) && ContainsString( rls, "(Thirty One)" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "FC31" );
		return ret;
	}
	if(ContainsString( rls, "Mandriva Linux Enterprise Server release 5.0" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "MNDK_mes5" );
		return ret;
	}
	if(ContainsString( rls, "Mandriva Linux Enterprise Server release 5.1" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "MNDK_mes5.1" );
		return ret;
	}
	if(ContainsString( rls, "Mandriva Linux Enterprise Server release 5.2" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "MNDK_mes5.2" );
		return ret;
	}
	if(ContainsString( rls, "Mandriva Linux release 2011.0" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "MNDK_2011.0" );
		return ret;
	}
	if(ContainsString( rls, "Mandriva Linux release 2010.2" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "MNDK_2010.2" );
		return ret;
	}
	if(ContainsString( rls, "Mandriva Linux release 2010.1" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "MNDK_2010.1" );
		return ret;
	}
	if(ContainsString( rls, "Mandriva Linux release 2010.0" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "MNDK_2010.0" );
		return ret;
	}
	if(ContainsString( rls, "Mandriva Linux release 2009.1" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "MNDK_2009.1" );
		return ret;
	}
	if(ContainsString( rls, "Mandriva Linux release 2009.0" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "MNDK_2009.0" );
		return ret;
	}
	if(ContainsString( rls, "Mandriva Linux release 2008.1" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "MNDK_2008.1" );
		return ret;
	}
	if(ContainsString( rls, "Mandriva Linux release 2008.0" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "MNDK_2008.0" );
		return ret;
	}
	if(ContainsString( rls, "Mandriva Linux release 2007.1" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "MNDK_2007.1" );
	}
	if(ContainsString( rls, "Mandriva Linux release 2007.0" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "MNDK_2007.0" );
		return ret;
	}
	if(ContainsString( rls, "Mandriva Linux release 2006.0" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "MNDK_2006.0" );
		return ret;
	}
	if(ContainsString( rls, "Mandrakelinux release 10.1" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "MNDK_10.1" );
		return ret;
	}
	if(ContainsString( rls, "Mandrake Linux release 10.0" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "MNDK_10.0" );
		return ret;
	}
	if(ContainsString( rls, "Mandrake Linux release 9.2" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "MNDK_9.2" );
		return ret;
	}
	if(ContainsString( rls, "Mandrake Linux release 9.1" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "MNDK_9.1" );
		return ret;
	}
	if(ContainsString( rls, "Mandrake Linux release 9.0" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "MNDK_9.0" );
		return ret;
	}
	if(ContainsString( rls, "Mandrake Linux release 8.2" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "MNDK_8.2" );
		return ret;
	}
	if(ContainsString( rls, "Mandrake Linux release 8.1" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "MNDK_8.1" );
		return ret;
	}
	if(ContainsString( rls, "Mandrake Linux release 8.0" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "MNDK_8.0" );
		return ret;
	}
	if(ContainsString( rls, "Mandrake Linux release 7.2" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: "MNDK_7.2" );
		return ret;
	}
	if(ContainsString( rls, "Mageia release 6" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Mageia release 6", oskey: "MAGEIA6" );
		return ret;
	}
	if(ContainsString( rls, "Mageia release 5" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Mageia release 5", oskey: "MAGEIA5" );
		return ret;
	}
	if(ContainsString( rls, "Mageia release 4.1" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Mageia release 4.1", oskey: "MAGEIA4.1" );
		return ret;
	}
	if(ContainsString( rls, "Mageia release 4" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Mageia release 4", oskey: "MAGEIA4" );
		return ret;
	}
	if(ContainsString( rls, "Mageia release 3" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Mageia release 3", oskey: "MAGEIA3" );
		return ret;
	}
	if(ContainsString( rls, "Mageia release 2" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Mageia release 2", oskey: "MAGEIA2" );
		return ret;
	}
	if(ContainsString( rls, "Mageia release 1" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Mageia release 1", oskey: "MAGEIA1" );
		return ret;
	}
	if(ContainsString( rls, "CentOS Linux release 7" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "CentOS release 7", oskey: "CentOS7" );
		return ret;
	}
	if(ContainsString( rls, "CentOS release 6" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "CentOS release 6", oskey: "CentOS6" );
		return ret;
	}
	if(ContainsString( rls, "CentOS release 5" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "CentOS release 5", oskey: "CentOS5" );
		return ret;
	}
	if(ContainsString( rls, "CentOS release 4" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "CentOS release 4", oskey: "CentOS4" );
		return ret;
	}
	if(ContainsString( rls, "CentOS release 3" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "CentOS release 3", oskey: "CentOS3" );
		return ret;
	}
	if(ContainsString( rls, "CentOS release 2" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};\\n'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "CentOS release 2", oskey: "CentOS2" );
		return ret;
	}
	rls = ssh_cmd( socket: soc, cmd: base_cmd + "cat /etc/lsb-release" );
	if(ContainsString( rls, "DISTRIB_ID=Ubuntu" ) && ContainsString( rls, "DISTRIB_RELEASE=4.10" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'COLUMNS=600 dpkg -l'", nosh: TRUE );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Ubuntu 4.10", oskey: "UBUNTU4.1" );
		return ret;
	}
	if(ContainsString( rls, "DISTRIB_ID=Ubuntu" ) && ContainsString( rls, "DISTRIB_RELEASE=5.04" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'COLUMNS=600 dpkg -l'", nosh: TRUE );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Ubuntu 5.04", oskey: "UBUNTU5.04" );
		return ret;
	}
	if(ContainsString( rls, "DISTRIB_ID=Ubuntu" ) && ContainsString( rls, "DISTRIB_RELEASE=5.10" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'COLUMNS=600 dpkg -l'", nosh: TRUE );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Ubuntu 5.10", oskey: "UBUNTU5.10" );
		return ret;
	}
	if(ContainsString( rls, "DISTRIB_ID=Ubuntu" ) && ContainsString( rls, "DISTRIB_RELEASE=6.06" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'COLUMNS=600 dpkg -l'", nosh: TRUE );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Ubuntu 6.06", oskey: "UBUNTU6.06 LTS" );
		return ret;
	}
	if(ContainsString( rls, "DISTRIB_ID=Ubuntu" ) && ContainsString( rls, "DISTRIB_RELEASE=6.10" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'COLUMNS=600 dpkg -l'", nosh: TRUE );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Ubuntu 6.10", oskey: "UBUNTU6.10" );
		return ret;
	}
	if(ContainsString( rls, "DISTRIB_ID=Ubuntu" ) && ContainsString( rls, "DISTRIB_RELEASE=7.04" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'COLUMNS=600 dpkg -l'", nosh: TRUE );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Ubuntu 7.04", oskey: "UBUNTU7.04" );
		return ret;
	}
	if(ContainsString( rls, "DISTRIB_ID=Ubuntu" ) && ContainsString( rls, "DISTRIB_RELEASE=7.10" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'COLUMNS=600 dpkg -l'", nosh: TRUE );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Ubuntu 7.10", oskey: "UBUNTU7.10" );
		return ret;
	}
	if(ContainsString( rls, "DISTRIB_ID=Ubuntu" ) && ContainsString( rls, "DISTRIB_RELEASE=8.04" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'COLUMNS=600 dpkg -l'", nosh: TRUE );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Ubuntu 8.04 LTS", oskey: "UBUNTU8.04 LTS" );
		return ret;
	}
	if(ContainsString( rls, "DISTRIB_ID=Ubuntu" ) && ContainsString( rls, "DISTRIB_RELEASE=8.10" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'COLUMNS=600 dpkg -l'", nosh: TRUE );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Ubuntu 8.10", oskey: "UBUNTU8.10" );
		return ret;
	}
	if(ContainsString( rls, "DISTRIB_ID=Ubuntu" ) && ContainsString( rls, "DISTRIB_RELEASE=9.04" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'COLUMNS=600 dpkg -l'", nosh: TRUE );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Ubuntu 9.04", oskey: "UBUNTU9.04" );
		return ret;
	}
	if(ContainsString( rls, "DISTRIB_ID=Ubuntu" ) && ContainsString( rls, "DISTRIB_RELEASE=9.10" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'COLUMNS=600 dpkg -l'", nosh: TRUE );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Ubuntu 9.10", oskey: "UBUNTU9.10" );
		return ret;
	}
	if(ContainsString( rls, "DISTRIB_ID=Ubuntu" ) && ContainsString( rls, "DISTRIB_RELEASE=10.04" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'COLUMNS=600 dpkg -l'", nosh: TRUE );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Ubuntu 10.04 LTS", oskey: "UBUNTU10.04 LTS" );
		return ret;
	}
	if(ContainsString( rls, "DISTRIB_ID=Ubuntu" ) && ContainsString( rls, "DISTRIB_RELEASE=10.10" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'COLUMNS=600 dpkg -l'", nosh: TRUE );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Ubuntu 10.10", oskey: "UBUNTU10.10" );
		return ret;
	}
	if(ContainsString( rls, "DISTRIB_ID=Ubuntu" ) && ContainsString( rls, "DISTRIB_RELEASE=11.04" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'COLUMNS=600 dpkg -l'", nosh: TRUE );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Ubuntu 11.04", oskey: "UBUNTU11.04" );
		return ret;
	}
	if(ContainsString( rls, "DISTRIB_ID=Ubuntu" ) && ContainsString( rls, "DISTRIB_RELEASE=11.10" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'COLUMNS=600 dpkg -l'", nosh: TRUE );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Ubuntu 11.10", oskey: "UBUNTU11.10" );
		return ret;
	}
	if(ContainsString( rls, "DISTRIB_ID=Ubuntu" ) && ContainsString( rls, "DISTRIB_RELEASE=12.04" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'COLUMNS=600 dpkg -l'", nosh: TRUE );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Ubuntu 12.04 LTS", oskey: "UBUNTU12.04 LTS" );
		return ret;
	}
	if(ContainsString( rls, "DISTRIB_ID=Ubuntu" ) && ContainsString( rls, "DISTRIB_RELEASE=12.10" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'COLUMNS=600 dpkg -l'", nosh: TRUE );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Ubuntu 12.10", oskey: "UBUNTU12.10" );
		return ret;
	}
	if(ContainsString( rls, "DISTRIB_ID=Ubuntu" ) && ContainsString( rls, "DISTRIB_RELEASE=13.04" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'COLUMNS=600 dpkg -l'", nosh: TRUE );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Ubuntu 13.04", oskey: "UBUNTU13.04" );
		return ret;
	}
	if(ContainsString( rls, "DISTRIB_ID=Ubuntu" ) && ContainsString( rls, "DISTRIB_RELEASE=13.10" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'COLUMNS=600 dpkg -l'", nosh: TRUE );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Ubuntu 13.10", oskey: "UBUNTU13.10" );
		return ret;
	}
	if(ContainsString( rls, "DISTRIB_ID=Ubuntu" ) && ContainsString( rls, "DISTRIB_RELEASE=14.04" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'COLUMNS=600 dpkg -l'", nosh: TRUE );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Ubuntu 14.04 LTS", oskey: "UBUNTU14.04 LTS" );
		return ret;
	}
	if(ContainsString( rls, "DISTRIB_ID=Ubuntu" ) && ContainsString( rls, "DISTRIB_RELEASE=14.10" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'COLUMNS=600 dpkg -l'", nosh: TRUE );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Ubuntu 14.10", oskey: "UBUNTU14.10" );
		return ret;
	}
	if(ContainsString( rls, "DISTRIB_ID=Ubuntu" ) && ContainsString( rls, "DISTRIB_RELEASE=15.04" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'COLUMNS=600 dpkg -l'", nosh: TRUE );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Ubuntu 15.04", oskey: "UBUNTU15.04" );
		return ret;
	}
	if(ContainsString( rls, "DISTRIB_ID=Ubuntu" ) && ContainsString( rls, "DISTRIB_RELEASE=15.10" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'COLUMNS=600 dpkg -l'", nosh: TRUE );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Ubuntu 15.10", oskey: "UBUNTU15.10" );
		return ret;
	}
	if(ContainsString( rls, "DISTRIB_ID=Ubuntu" ) && ContainsString( rls, "DISTRIB_RELEASE=16.04" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'COLUMNS=600 dpkg -l'", nosh: TRUE );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Ubuntu 16.04 LTS", oskey: "UBUNTU16.04 LTS" );
		return ret;
	}
	if(ContainsString( rls, "DISTRIB_ID=Ubuntu" ) && ContainsString( rls, "DISTRIB_RELEASE=16.10" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'COLUMNS=600 dpkg -l'", nosh: TRUE );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Ubuntu 16.10", oskey: "UBUNTU16.10" );
		return ret;
	}
	if(ContainsString( rls, "DISTRIB_ID=Ubuntu" ) && ContainsString( rls, "DISTRIB_RELEASE=17.04" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'COLUMNS=600 dpkg -l'", nosh: TRUE );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Ubuntu 17.04", oskey: "UBUNTU17.04" );
		return ret;
	}
	if(ContainsString( rls, "DISTRIB_ID=Ubuntu" ) && ContainsString( rls, "DISTRIB_RELEASE=17.10" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'COLUMNS=600 dpkg -l'", nosh: TRUE );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Ubuntu 17.10", oskey: "UBUNTU17.10" );
		return ret;
	}
	if(ContainsString( rls, "DISTRIB_ID=Ubuntu" ) && ContainsString( rls, "DISTRIB_RELEASE=18.04" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'COLUMNS=600 dpkg -l'", nosh: TRUE );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Ubuntu 18.04 LTS", oskey: "UBUNTU18.04 LTS" );
		return ret;
	}
	if(ContainsString( rls, "DISTRIB_ID=Ubuntu" ) && ContainsString( rls, "DISTRIB_RELEASE=18.10" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'COLUMNS=600 dpkg -l'", nosh: TRUE );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Ubuntu 18.10", oskey: "UBUNTU18.10" );
		return ret;
	}
	if(ContainsString( rls, "DISTRIB_ID=Ubuntu" ) && ContainsString( rls, "DISTRIB_RELEASE=19.04" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'dpkg --no-pager -l'", nosh: TRUE );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Ubuntu 19.04", oskey: "UBUNTU19.04" );
		return ret;
	}
	if(ContainsString( rls, "DISTRIB_ID=Ubuntu" ) && ContainsString( rls, "DISTRIB_RELEASE=19.10" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'dpkg --no-pager -l'", nosh: TRUE );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Ubuntu 19.10", oskey: "UBUNTU19.10" );
		return ret;
	}
	if(IsMatchRegexp( rls, "DISTRIB_ID=(\"|\')?Univention(\"|\')?" )){
		ucs_release = eregmatch( string: rls, pattern: "DISTRIB_RELEASE=\"([1-9][0-9]*[.][0-9]+)-([0-9]+) errata([0-9]+)[^\"]*\"" );
		if(!isnull( ucs_release[1] )){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/ucs/version", value: ucs_release[1] );
		}
		if(!isnull( ucs_release[2] )){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/ucs/patch", value: ucs_release[2] );
		}
		if(!isnull( ucs_release[3] )){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/ucs/errata", value: ucs_release[3] );
		}
		ucs_desciption = eregmatch( string: rls, pattern: "DISTRIB_DESCRIPTION=\"([^\"]*)\"" );
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'COLUMNS=600 dpkg -l'" );
		if(!isnull( buf ) && !isnull( ucs_release[1] ) && !isnull( ucs_desciption[1] )){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
			ret = register_detected_docker_os( container_id: container_id, os: ucs_desciption[1], oskey: "UCS" + ucs_release[1] );
			return ret;
		}
	}
	rls = ssh_cmd( socket: soc, cmd: base_cmd + "cat /etc/debian_version" );
	if(IsMatchRegexp( rls, "^[0-9]+[0-9.]+" ) || ContainsString( rls, "buster/sid" ) || ContainsString( rls, "bullseye/sid" )){
		rls = chomp( rls );
		cpe = "cpe:/o:debian:debian_linux";
		oskey = "DEB";
		if( ( IsMatchRegexp( rls, "^[0-9]+[0-9.]+" ) && version_is_greater_equal( version: rls, test_version: "10" ) ) || ContainsString( rls, "buster/sid" ) || ContainsString( rls, "bullseye/sid" ) ){
			buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'dpkg --no-pager -l'", nosh: TRUE );
		}
		else {
			buf = ssh_cmd( socket: soc, cmd: base_cmd + "bash -c 'COLUMNS=600 dpkg -l'", nosh: TRUE );
		}
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/packages", value: ";" + buf );
		}
		vers = eregmatch( pattern: "^([0-9]+)([0-9.]+)", string: rls, icase: FALSE );
		if(vers[1]){
			cpe += ":" + vers[1];
			oskey += vers[1];
		}
		if(vers[2]){
			cpe += vers[2];
			if(IsMatchRegexp( vers[1], "^[1-3]$" )){
				oskey += "." + vers[2];
			}
		}
		if(!vers){
			if( ContainsString( rls, "buster/sid" ) ){
				cpe += ":10.0";
				oskey += "10";
			}
			else {
				if(ContainsString( rls, "bullseye/sid" )){
					cpe += ":11.0";
					oskey += "11";
				}
			}
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Debian " + rls, oskey: oskey, oscpe: cpe );
		return ret;
	}
	rls = ssh_cmd( socket: soc, cmd: base_cmd + "cat /etc/slackware-version" );
	if(ContainsString( rls, "Slackware 14.2" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 14.2", oskey: "SLK14.2" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 14.1" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 14.1", oskey: "SLK14.1" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 14.0" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 14.0", oskey: "SLK14.0" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 13.37" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 13.37", oskey: "SLK13.37" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 13.1" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 13.1", oskey: "SLK13.1" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 13.0" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 13.0", oskey: "SLK13.0" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 12.2" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 12.2", oskey: "SLK12.2" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 12.1" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 12.1", oskey: "SLK12.1" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 12.0" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 12.0", oskey: "SLK12.0" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 11.0" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 11.0", oskey: "SLK11.0" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 10.2" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 10.2", oskey: "SLK10.2" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 10.1" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 10.1", oskey: "SLK10.1" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 10.0" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 10.0", oskey: "SLK10.0" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 9.1" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 9.1", oskey: "SLK9.1" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 9.0" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 9.0", oskey: "SLK9.0" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 8.1" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 8.1", oskey: "SLK8.1" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 8.0" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 8.0", oskey: "SLK8.0" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 7.1" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 7.1", oskey: "SLK7.1" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 7.0" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 7.0", oskey: "SLK7.0" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 4.0" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 4.0", oskey: "SLK4.0" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 3.9" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 3.9", oskey: "SLK3.9" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 3.6" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 3.6", oskey: "SLK3.6" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 3.5" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 3.5", oskey: "SLK3.5" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 3.4" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 3.4", oskey: "SLK3.4" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 3.3" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 3.3", oskey: "SLK3.3" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 3.2" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 3.2", oskey: "SLK3.2" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 3.1" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 3.1", oskey: "SLK3.1" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 3.0" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 3.0", oskey: "SLK3.0" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 2.3" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 2.3", oskey: "SLK2.3" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 2.2" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 2.2", oskey: "SLK2.2" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 2.1" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 2.1", oskey: "SLK2.1" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 2.0" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 2.0", oskey: "SLK2.0" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 1.1" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 1.1", oskey: "SLK1.1" );
		return ret;
	}
	if(ContainsString( rls, "Slackware 1.00" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "ls /var/log/packages" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/slackpack", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "Slackware 1.00", oskey: "SLK1.00" );
		return ret;
	}
	rls = ssh_cmd( socket: soc, cmd: base_cmd + "cat /etc/os-release" );
	if(!rls){
		rls = ssh_cmd( socket: soc, cmd: base_cmd + "cat /usr/lib/os-release" );
	}
	if(ContainsString( rls, "openSUSE Leap 15.1" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "openSUSE Leap 15.1", oskey: "openSUSELeap15.1" );
		return ret;
	}
	if(ContainsString( rls, "openSUSE Leap 15.0" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "openSUSE Leap 15.0", oskey: "openSUSELeap15.0" );
		return ret;
	}
	if(ContainsString( rls, "openSUSE Leap 42.3" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "openSUSE Leap 42.3", oskey: "openSUSELeap42.3" );
		return ret;
	}
	if(ContainsString( rls, "openSUSE Leap 42.2" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "openSUSE Leap 42.2", oskey: "openSUSELeap42.2" );
		return ret;
	}
	if(ContainsString( rls, "openSUSE Leap 42.1" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "openSUSE Leap 42.1", oskey: "openSUSELeap42.1" );
		return ret;
	}
	if(ContainsString( rls, "openSUSE Leap 42.0" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "openSUSE Leap 42.0", oskey: "openSUSELeap42.0" );
		return ret;
	}
	if(ContainsString( rls, "NAME=\"Arch Linux\"" )){
		ret = register_detected_docker_os( container_id: container_id, os: "Arch Linux", oskey: "ArchLinux" );
		return ret;
	}
	if(ContainsString( rls, "NAME=NixOS" ) || ContainsString( rls, "ID=nixos" )){
		ret = register_detected_docker_os( container_id: container_id, os: "NixOS", oskey: "NixOS" );
		return ret;
	}
	rls = ssh_cmd( socket: soc, cmd: base_cmd + "cat /etc/SuSE-release" );
	if(ContainsString( rls, "openSUSE 13.2 " )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "openSUSE 13.2", oskey: "openSUSE13.2" );
		return ret;
	}
	if(ContainsString( rls, "openSUSE 13.1 " )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "openSUSE 13.1", oskey: "openSUSE13.1" );
		return ret;
	}
	if(ContainsString( rls, "openSUSE 12.3 " )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "openSUSE 12.3", oskey: "openSUSE12.3" );
		return ret;
	}
	if(ContainsString( rls, "openSUSE 12.2 " )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "openSUSE 12.2", oskey: "openSUSE12.2" );
		return ret;
	}
	if(ContainsString( rls, "openSUSE 12.1 " )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "openSUSE 12.1", oskey: "openSUSE12.1" );
		return ret;
	}
	if(ContainsString( rls, "openSUSE 11.4 " )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "openSUSE 11.4", oskey: "openSUSE11.4" );
		return ret;
	}
	if(ContainsString( rls, "openSUSE 11.3 " )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "openSUSE 11.3", oskey: "openSUSE11.3" );
		return ret;
	}
	if(ContainsString( rls, "openSUSE 11.2 " )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "openSUSE 11.2", oskey: "openSUSE11.2" );
		return ret;
	}
	if(ContainsString( rls, "openSUSE 11.1 " )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "openSUSE 11.1", oskey: "openSUSE11.1" );
		return ret;
	}
	if(ContainsString( rls, "openSUSE 11.0 " )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "openSUSE 11.0", oskey: "openSUSE11.0" );
		return ret;
	}
	if(ContainsString( rls, "openSUSE 10.3 " )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "openSUSE 10.3", oskey: "openSUSE10.3" );
		return ret;
	}
	if(ContainsString( rls, "openSUSE 10.2 " )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "openSUSE 10.2", oskey: "openSUSE10.2" );
		return ret;
	}
	if(ContainsString( rls, "SUSE LINUX 10.1 " )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "SuSE Linux 10.1", oskey: "SUSE10.1" );
		return ret;
	}
	if(ContainsString( rls, "SUSE LINUX 10.0 " )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "SuSE Linux 10.0", oskey: "SUSE10.0" );
		return ret;
	}
	if(ContainsString( rls, "SuSE Linux 9.3 " )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "SuSE Linux 9.3", oskey: "SUSE9.3" );
		return ret;
	}
	if(ContainsString( rls, "SuSE Linux 9.2 " )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "SuSE Linux 9.2", oskey: "SUSE9.2" );
		return ret;
	}
	if(ContainsString( rls, "SuSE Linux 9.1 " )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "SuSE Linux 9.1", oskey: "SUSE9.1" );
		return ret;
	}
	if(ContainsString( rls, "SuSE Linux 9.0 " )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "SuSE Linux 9.0", oskey: "SUSE9.0" );
		return ret;
	}
	if(ContainsString( rls, "SuSE Linux 8.2 " )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "SuSE Linux 8.2", oskey: "SUSE8.2" );
		return ret;
	}
	if(ContainsString( rls, "SuSE Linux 8.1 " )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "SuSE Linux 8.1", oskey: "SUSE8.1" );
		return ret;
	}
	if(ContainsString( rls, "SuSE Linux 8.0 " )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "SuSE Linux 8.0", oskey: "SUSE8.0" );
		return ret;
	}
	if(ContainsString( rls, "SuSE Linux 7.3 " )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		ret = register_detected_docker_os( container_id: container_id, os: "SuSE Linux 7.3", oskey: "SUSE7.3" );
		return ret;
	}
	rls = ssh_cmd( socket: soc, cmd: base_cmd + "cat /etc/euleros-release" );
	if(IsMatchRegexp( rls, "EulerOS release" )){
		rls = chomp( rls );
		cpe = "cpe:/o:huawei:euleros";
		oskey = "EULEROS";
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "/bin/rpm -qa --qf '%{NAME}~%{VERSION}~%{RELEASE};'" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/rpms", value: ";" + buf );
		}
		vers_nd_sp = eregmatch( pattern: "^EulerOS release ([0-9]+\\.[0-9]+)( \\(SP([0-9]+)\\))?", string: rls, icase: TRUE );
		if(vers_nd_sp[1]){
			cpe += vers_nd_sp[1];
			oskey += vers_nd_sp[1];
			if( vers_nd_sp[3] ){
				cpe += ":sp" + vers_nd_sp[3];
				oskey += "SP" + vers_nd_sp[3];
			}
			else {
				oskey += "SP0";
			}
		}
		ret = register_detected_docker_os( container_id: container_id, os: rls, oskey: oskey, oscpe: cpe );
		return ret;
	}
	rls = ssh_cmd( socket: soc, cmd: base_cmd + "cat /etc/gentoo-release" );
	if(ContainsString( rls, "Gentoo" )){
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "find /var/db/pkg -mindepth 2 -maxdepth 2 -printf \"%P\\n\"" );
		if(buf){
			set_kb_item( name: "docker/lsc/container/" + container_id + "/pkg", value: ";" + buf );
		}
		buf = ssh_cmd( socket: soc, cmd: base_cmd + "find /usr/portage/ -wholename '/usr/portage/*-*/*.ebuild' | sed 's,/usr/portage/\\([^/]*\\)/.*/\\([^/]*\\)\\.ebuild$,\\1/\\2,'" );
		if(strlen( buf ) == 0){
			buf = ssh_cmd( socket: soc, cmd: base_cmd + "find /usr/portage/ -path '/usr/portage/*-*/*.ebuild' | sed 's,/usr/portage/\\([^/]*\\)/.*/\\([^/]*\\)\\.ebuild$,\\1/\\2,'" );
		}
		set_kb_item( name: "docker/lsc/container/" + container_id + "/gentoo_maintained", value: buf );
		ret = register_detected_docker_os( container_id: container_id, os: "Gentoo", oskey: "GENTOO" );
		return ret;
	}
	rls = ssh_cmd( socket: soc, cmd: base_cmd + "cat /etc/release" );
	if(_rls = egrep( string: rls, pattern: "OpenIndiana ", icase: FALSE )){
		_rls = chomp( _rls );
		openi_cpe = "cpe:/o:openindiana:openindiana";
		os_name = "OpenIndiana";
		if( ContainsString( _rls, " Development " ) ){
			openi_version = eregmatch( pattern: "OpenIndiana Development oi_([0-9.]+)", string: _rls );
			openi_cpe += "_development";
			os_key = "OPENINDIANADEV";
		}
		else {
			if( ContainsString( _rls, " Hipster " ) ){
				openi_version = eregmatch( pattern: "OpenIndiana Hipster ([0-9.]+)", string: _rls );
				openi_cpe += "_hipster";
				os_name += " Hipster";
				os_key = "OPENINDIANAHIPSTER";
			}
			else {
				openi_cpe += "_unknown_release";
				os_name += " Unknown Release";
				os_key = "OPENINDIANAUNKNOWN";
			}
		}
		if(!isnull( openi_version[1] )){
			openi_cpe += ":" + openi_version[1];
		}
		ret = register_detected_docker_os( container_id: container_id, os: os_name, oskey: os_key, oscpe: openi_cpe );
		return ret;
	}
}

